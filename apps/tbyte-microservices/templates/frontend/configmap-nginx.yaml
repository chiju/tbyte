apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "tbyte-microservices.fullname" . }}-frontend-config
  namespace: {{ .Release.Namespace }}
data:
  nginx.conf: |
    server {
        listen 80;
        server_name localhost;
        
        # This will cause all requests to return 503 and fail readiness probe
        location / {
            return 503 "Service Unavailable - Testing Rollback";
        }
        
        location /api/ {
            return 503 "API Unavailable - Testing Rollback";
        }
    }
