image:
  repository: 045129524082.dkr.ecr.eu-central-1.amazonaws.com/tbyte-dev-frontend
  tag: "ec28e158"
  pullPolicy: Always

service:
  type: ClusterIP
  port: 80

canary:
  enabled: true
  # Automatic Rollback Configuration
  analysis:
    enabled: true
    template: success-rate
    startingStep: 2  # Start analysis after 25% traffic
  # Rollback Thresholds (Industry Standards)
  thresholds:
    successRate: 0.95      # 95% success rate minimum
    latencyP95: 0.5        # 500ms P95 latency maximum  
    errorRate: 0.01        # 1% error rate maximum
    cpuUsage: 0.8          # 80% CPU usage maximum
    memoryUsage: 100000000 # 100MB memory maximum
  # Canary Steps with Analysis
  steps:
    - setWeight: 10
    - pause: 30s
    - setWeight: 25
    - pause: 60s           # Analysis runs here
    - setWeight: 50
    - pause: 60s
    - setWeight: 75
    - pause: 30s

istio:
  enabled: true
  virtualService: common-routes
  namespace: istio-system

# Automatic Rollback Settings
rollback:
  enabled: true
  failureLimit: 3          # Max failures before rollback
  abortScaleDownDelay: 30  # Wait 30s before scaling down failed pods
  progressDeadline: 600    # 10 minutes max deployment time

resources:
  requests:
    memory: "64Mi"
    cpu: "50m"
  limits:
    memory: "128Mi" 
    cpu: "100m"

replicas: 3

# Monitoring Integration
monitoring:
  prometheus:
    enabled: true
    address: "http://kube-prometheus-stack-prometheus.monitoring:9090"
  alerts:
    enabled: true
    webhook: ""  # Add Slack/Teams webhook for notifications
